<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="shortcut icon" type="image/png" href="favicon-32.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      #c {
        border: 1px solid black;
      }
    </style>
  </head>
  <body>
    <!-- the canvas -->
    <canvas id="c" width="400" height="300"></canvas>

    <!-- download link -->
    <a href="#" id="b">Click</a>

    <!-- scripts -->
    <script src="jquery-3.5.1.min.js"></script>
    <script src="fabric.min.js"></script>

    <script>
      /* 
        in this file:
        - shape
        - animate
        - download image
        - text
        */

      // initialize script
      let canvas = new fabric.Canvas("c");

      // make background white
      canvas.backgroundColor = "white";

      // rectangle
      let rect = new fabric.Rect({
        left: 0,
        top: 200,
        fill: "red",
        width: 250,
        height: 40,
        // angle: 20,
        hasControls: false,
        hasBorders: false,
        lockMovementX: true,
        lockMovementY: true,
        lockRotation: true,
        selectable: false,
        hoverCursor: "arrow",
      });

      canvas.add(rect);

      // download

      $("#b").click(saveImage);

      function saveImage(e) {
        console.log(e);
        this.href = canvas.toDataURL({
          format: "png",
          multiplier: 2,
        });
        this.download = "frontside@2x.png";
      }

      // text

      var text = new fabric.Text("hello world, \nthis is a nice day", {
        left: 24,
        top: 180,
        right: 24,
        editable: false,
        hasControls: false,
        hasBorders: false,
        lockMovementX: true,
        lockMovementY: true,
        lockRotation: true,
        selectable: false,
        hoverCursor: "arrow",
      });

      canvas.add(text);

      // animate

      rect.animate("left", 100, {
        onChange: canvas.renderAll.bind(canvas),
      });
    </script>
  </body>
</html>
